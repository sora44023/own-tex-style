% 余白設定
\setlength{\textwidth}{\fullwidth}
\setlength{\textheight}{40\baselineskip}
\addtolength{\textheight}{\topskip}
\setlength{\voffset}{-0.2in}
\setlength{\topmargin}{0pt}
\setlength{\headheight}{0pt}
\setlength{\headsep}{0pt}

% 条件分岐用
\usepackage{ifthen}

% フォント
\usepackage{zxjatype}
\usepackage[haranoaji]{zxjafont}
\usepackage{fontspec}
\setmonofont{Ricty Discord}
\usepackage{color}

% 数式
\usepackage{amsmath,amssymb,amsthm}
\usepackage{siunitx}
\usepackage{bm}
\usepackage{braket}
\usepackage{array}
\usepackage{cancel}
\usepackage{diffcoeff}

% 画像挿入簡略化
\newcommand{\inputpic}[2]{%
\includegraphics[width={#2}\linewidth]{#1}}
\newcommand{\twocolpage}[2]{%
\begin{minipage}[b]{.5\linewidth}\centering #1\end{minipage}%
\begin{minipage}[b]{.5\linewidth}\centering #2\end{minipage}}
\newcommand{\twofigure}[4][h]{%
\begin{figure}[#1]\centering\twocolpage{#2}{#3}#4\end{figure}}

% 表紙
\makeatletter
\def\subtitle#1{\def\@subtitle{#1}}
\def\gakka#1{\def\@gakka{#1}}
\def\grade#1{\def\@grade{#1}}
\def\stuid#1{\def\@stuid{#1}}
\def\expdate#1{\def\@expdate{#1}}
\def\coauthor#1{\def\@coauthor{#1}}
\global\let\@subtitle\@empty
\global\let\@gakka\@empty
\global\let\@grade\@empty
\global\let\@stuid\@empty
\global\let\@expdate\@empty
\global\let\@coauthor\@empty

\newcommand{\maketitlepage}{%
    \thispagestyle{empty}  % ベージ番号なし
    \null\vfill
    \begin{center}
        {\Huge \sffamily \@title \par}
        \ifthenelse{\equal{\@subtitle}{}}{}{%
            \vspace{5mm}
            {\LARGE \sffamily \@subtitle \par}
        }
        \vspace{20mm}
        {\Large \@gakka \ \@grade 年 \@stuid 号 \par}
        \vspace{3mm}
        {\Large \@author \par}
        \vspace{8mm}
        \begin{table}[h]
            \Large \centering
            \begin{tabular}{rl}
                \ifthenelse{\equal{\@expdate}{}}{}{%
                実験日： & \@expdate \\
                }
                提出日： & \@date
            \end{tabular}
        \end{table}
        \vspace{8mm}
        \ifthenelse{\equal{\@coauthor}{}}{}{%
            {\Large 共同実験者：\hspace{1mm}}
            \begin{minipage}[t]{14em}
                \begin{flushleft}
                    \Large \@coauthor
                \end{flushleft}
            \end{minipage}
        }
    \end{center}
    \vfill
    \clearpage
    \setcounter{page}{1}  % ここからページ番号振り始め
    \pagestyle{plain}
}
\makeatother

% ソースコード
\usepackage{listings}
\lstdefinestyle{ex}{
    frame={trbl},
    frameround={tttt},
    lineskip=-0.7ex,
    numbers=none
}
\lstdefinestyle{default}{
    basicstyle=\ttfamily,
    commentstyle = {\color[cmyk]{1,0.4,1,0}},
    classoffset = 0,  %関数名等の色の設定
    keywordstyle = {\bfseries \color{magenta}},  %キーワード(int, ifなど)の書体
    keywordstyle = [2]{\bfseries \color[rgb]{1,0.55,0}},
    keywordstyle = [3]{\bfseries \color[rgb]{0.28,0.24,0.545}},
    keywordstyle = [4]{\bfseries \color{cyan}},
    keywordstyle = [5]{\bfseries \color[rgb]{0,0.5,0}},
    stringstyle = {\ttfamily \color[rgb]{0,0,1}},  %""で囲まれたなどの"文字"の書体
    breaklines=true,  %枠外に行った時の自動改行
    escapechar=\`,
    columns=[l]{fullflexible},
    keepspaces=true,
    showstringspaces=false,
    xrightmargin=0em,
    xleftmargin=1em,
    stepnumber=1,
    lineskip=-0.5ex,
    frame={lrtb},
    frameround={nnnn},
    numberstyle={\scriptsize},
    numbers=left
}
\lstset{style=default}  % set default style
\renewcommand{\lstlistingname}{ソースコード}